
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Theory Day 2 &#8212; Open Ephys EEA 2022 0.0.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Theory Day 3" href="theoryday3.html" />
    <link rel="prev" title="Theory Day 1" href="theoryday1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">Open Ephys EEA 2022</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="kitlist.html">
  NeuroKit Contents
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="eeadocsindex.html">
  EEA Course Documents
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="disclaimer_terms_conditions.html">
  Terms and Conditions
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="license.html">
  Licensing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="acknowledgements.html">
  Acknowledgements
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://open-ephys.org">Open Ephys<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ahleighton/OE-ephys-course" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/openephys" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://discord.gg/vSg5UDcCwB" rel="noopener" target="_blank" title="Discord"><span><i class="fab fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="safety.html">
   Safety &amp; Good Practices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="software_requirements.html">
   Software Requirements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theoryday1.html">
   Theory Day 1
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Theory Day 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theoryday3.html">
   Theory Day 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theoryday4.html">
   Theory Day 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exday1.html">
   Exercises Day 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exday2.html">
   Exercises Day 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exday3.html">
   Exercises Day 3
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="exday4.html">
   Exercises Day 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Firmata.html">
     Firmata 2000
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="projects.html">
   Project
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exday1_nokit.html">
   Exercises Day 1: No Hardware
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exday2_nokit.html">
   Exercises Day 2: No Hardware
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#impedance-ratios-determine-signal-transmission">
   Impedance ratios determine signal transmission
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-is-impedance-important">
     Why is impedance important?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#electrode-impedance">
     Electrode Impedance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shunt-impedance">
     Shunt Impedance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#amplifiers">
   Amplifiers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#amplifiers-in-the-headstage-prevent-current-being-drawn">
     Amplifiers in the headstage prevent current being drawn
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-operational-amplifier">
     The operational amplifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#amplifiers-have-high-input-impedance">
     Amplifiers have high input impedance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#amplifiers-have-low-output-impedance">
     Amplifiers have low output impedance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#amplifiers-output-a-voltage">
     Amplifiers output a voltage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#negative-feedback-prevents-saturation">
     Negative feedback prevents saturation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#an-op-amp-as-a-headstage">
     An op-amp as a headstage
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/ahleighton/OE-ephys-course/edit/main/source/EEA/theoryday2.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="theory-day-2">
<span id="reftday2"></span><h1>Theory Day 2<a class="headerlink" href="#theory-day-2" title="Permalink to this headline">#</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#impedance-ratios-determine-signal-transmission" id="id1">Impedance ratios determine signal transmission</a></p>
<ul>
<li><p><a class="reference internal" href="#why-is-impedance-important" id="id2">Why is impedance important?</a></p></li>
<li><p><a class="reference internal" href="#electrode-impedance" id="id3">Electrode Impedance</a></p></li>
<li><p><a class="reference internal" href="#shunt-impedance" id="id4">Shunt Impedance</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#amplifiers" id="id5">Amplifiers</a></p>
<ul>
<li><p><a class="reference internal" href="#amplifiers-in-the-headstage-prevent-current-being-drawn" id="id6">Amplifiers in the headstage prevent current being drawn</a></p></li>
<li><p><a class="reference internal" href="#the-operational-amplifier" id="id7">The operational amplifier</a></p></li>
<li><p><a class="reference internal" href="#amplifiers-have-high-input-impedance" id="id8">Amplifiers have high input impedance</a></p></li>
<li><p><a class="reference internal" href="#amplifiers-have-low-output-impedance" id="id9">Amplifiers have low output impedance</a></p></li>
<li><p><a class="reference internal" href="#amplifiers-output-a-voltage" id="id10">Amplifiers output a voltage</a></p></li>
<li><p><a class="reference internal" href="#negative-feedback-prevents-saturation" id="id11">Negative feedback prevents saturation</a></p></li>
<li><p><a class="reference internal" href="#an-op-amp-as-a-headstage" id="id12">An op-amp as a headstage</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Yesterday, we said that an acquisition system must:</p>
<ul class="simple">
<li><p><em>Detect</em> changes in electric potential difference</p></li>
<li><p><strong>Faithfully *transfer* this signal to our acquisition system output</strong></p></li>
<li><p>Distinguish interesting biological <em>signals</em> from other sources of electrical <em>noise</em></p></li>
</ul>
<section id="impedance-ratios-determine-signal-transmission">
<h2><a class="toc-backref" href="#id1">Impedance ratios determine signal transmission</a><a class="headerlink" href="#impedance-ratios-determine-signal-transmission" title="Permalink to this headline">#</a></h2>
<img alt="../_images/black_box_recording_system.png" class="align-center" src="../_images/black_box_recording_system.png" />
<p>The signal V<sub>ec</sub> (V electrode) is measured at the electrode tip. V<sub>in</sub> is the voltage that enters the acquisition system. V<sub>out</sub> is the signal output of the acquisition system. Faithfully transferring the signal means not losing (much) signal between V<sub>ec</sub>, V<sub>in</sub>, and V<sub>out</sub>. This is all based on the idea of voltage dividers; that the voltage between two impedances in series will be determined by the ratio of their impedances.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<center><iframe width="560" height="340" src="https://www.youtube.com/embed/fVloDI4b1ts" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></center>
<br><section id="why-is-impedance-important">
<h3><a class="toc-backref" href="#id2">Why is impedance important?</a><a class="headerlink" href="#why-is-impedance-important" title="Permalink to this headline">#</a></h3>
<p>The figure below includes the equivalent circuit of the electrode, as discussed yesterday. The signal V<sub>ec</sub> must travel through the electrode, to V<sub>in</sub>, the voltage before the acquisition system itself. From there, currents coming from our neurons travel to ground. They can do so either by passing through our acquisition system, or (in parallel) they can be lost to ground through shunt impedance. Shunt impedance is primarily capacitive (see section below) and represented as (C<sub>s</sub>). Shunt capacitances are created by cables or the sides of electrodes; they are ‘accidental’ but unavoidable capacitances in the system.</p>
<img alt="equivalent circuit of the electrode, with a subsequent capacitance to ground representing shunt capacitance" class="align-center" src="../_images/circuit_electrode_shunt_capacitance.png" />
<p>We can replace these components with a representation of the impedance (Z) they provide.</p>
<img alt="equivalent circuit of electrode, shunt capacitance and acquisition system with each component represented as an impedance." class="align-center" src="../_images/circuit_impedance_shunt_capacitance.png" />
<p>The impedance of the shunt capacitance, Z<sub>cs</sub> and the impedance of the acquisition system Z<sub>a</sub> are impedances in parallel.
We can simplify our circuit by combining their impedances and calling it Z<sub>a</sub>’.</p>
<img alt="The electrode impedance and the shunt+amplifier impedance in series, showing how these two parts form a voltage divider." class="align-center" src="../_images/shunt_amplifier_voltage_divider.png" />
<p>This gives us a voltage divider, similar to the one we built before, where:</p>
<div class="math notranslate nohighlight">
\[Vin = \frac{Za'}{Za'+Ze} Vec\]</div>
<p>The ratio of Z<sub>e</sub> and Z<sub>a</sub>’ therefore determines how much of our electrode tip voltage V<sub>ec</sub> reaches V<sub>in</sub>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>To get more of our voltage Vec into our recording system, we want to keep electrode impedance Ze low, and system input impedance Za’ very high.</strong></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>If Z<sub>a</sub>’ is not substantially greater than Z<sub>e</sub>, V<sub>in</sub> will be much lower than V<sub>ec</sub>. To have high Z<sub>a</sub>’, we need amplifiers with high input impedance and high shunt impedance.</p>
</section>
<section id="electrode-impedance">
<h3><a class="toc-backref" href="#id3">Electrode Impedance</a><a class="headerlink" href="#electrode-impedance" title="Permalink to this headline">#</a></h3>
<p>The impedance of an electrode is a measure of its ability to resist the flow of charge across the electrode-solution interface (i.e., across the electronic conductor (metal) and ionic conductor (extracellular fluid)). It is the impedance of the whole electrode equivalent circuit we built yesterday, consisting of the resistance of the electrode metal (R<sub>m</sub>) and the resistance (R<sub>e</sub>) and capacitance (C<sub>e</sub>) of the double layer at the electrode-solution interface.</p>
<img alt="../_images/circuit_double_layer_interface.png" class="align-center" src="../_images/circuit_double_layer_interface.png" />
<p>In polarized electrodes, the large R<sub>e</sub> prevents much current from taking this route. Therefore, in practice, the electrode is primarily the double-layer capacitor C<sub>e</sub> in series with R<sub>m</sub> and R<sub>s</sub> (Robinson, 1968).</p>
<p>So far, we know that the impedance magnitude of a capacitor decreases with increased capacitance, and that electrode impedance is dominated by double layer capacitor, C<sub>e</sub>. Therefore, to decrease our electrode impedance, we need to increase the electrode capacitance C<sub>e</sub>.
How can we increase the value of C<sub>e</sub>?</p>
<div class="math notranslate nohighlight">
\[C = \frac{\epsilon A}{d}\]</div>
<center><i> The capacitance of a capacitor (C, in Farads), is proportional to the area of the capacitor plates (A) divided by the distance (d) between them. ε is the electrostatic constant.</i></center><p>To make C bigger, we can increase the surface area (A) of the electrode, for instance by electroplating a thin layer of gold on to an electrode. We can also coat electrodes with materials complemented with pseudo-capacitance, such as conducting polymers or transition metal oxide films, such as IrOx (Green, Lovell, Wallace, &amp; Poole-Warren, 2008; Musa, 2011).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Electrode impedance magnitude is usually measured at 1 kHz, before and after electrode coating, allowing us to see an impedance decrease of up to 10-fold (Neto et al., 2018).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>By increasing the capacitance (C<sub>e</sub>) of our electrode, the electrode impedance (Z<sub>e</sub>) will be smaller, preserving more of our signal amplitude at V<sub>in</sub>.</p>
</section>
<section id="shunt-impedance">
<h3><a class="toc-backref" href="#id4">Shunt Impedance</a><a class="headerlink" href="#shunt-impedance" title="Permalink to this headline">#</a></h3>
<p>Shunt impedance is the total impedance of shunt capacitance C<sub>s</sub> and shunt resistance R<sub>sh</sub>. These are both routes to ground outside of the intended acquisition system. At the high frequencies (1kHz) we are interested in, the capacitive component will have relatively low impedance. It will therefore have more effect than the resistive component, so R<sub>sh</sub> is often ignored.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Remember that any two conducting surfaces, with a non-conducting layer in between, <em>is</em> a capacitor. Shunt capacitance arises mainly from the capacitance across the thin insulation layer isolating an electrode and the surrounding electrolyte, as well as the cumulative capacitance along cables and connectors (Robinson, 1968).</p>
<p>The shunt capacitance for a tungsten wire (~50 to 100 pF) is usually higher than for a silicon probe (5-20 pF/cm). (Why? Think of what makes a capacitor, and the relative shape and conductances of these electrodes).</p>
<div class="admonition-try-it-yourself admonition">
<p class="admonition-title">Try it yourself</p>
<p>Here is a model of the electrode with shunt capacitance, resistance, and amplifier in parallel to ground. You should see that either decreasing electrode impedance or increasing shunt impedance gives you a larger output voltage.</p>
<p><a class="reference external" href="https://tinyurl.com/yepsdold">https://tinyurl.com/yepsdold</a></p>
</div>
<p>We want a large shunt impedance, to prevent current from flowing down this route. Being capacitive, the impedance decreases with signal frequency (Nelson et al., 2008). Therefore, to create a large shunt impedance, the shunt capacitance should be small:</p>
<div class="math notranslate nohighlight">
\[Z = \frac{1}{2 \pi fC}\]</div>
<p>However, some shunt capacitance is inevitable and often there is not much we can do about it. Because the shunt impedance is in parallel with the impedance of the acquisition system, we can focus on increasing the acquisition system impedance to give us a large Z<sub>a</sub>’.</p>
</section>
</section>
<section id="amplifiers">
<span id="refamplifierintro"></span><h2><a class="toc-backref" href="#id5">Amplifiers</a><a class="headerlink" href="#amplifiers" title="Permalink to this headline">#</a></h2>
<section id="amplifiers-in-the-headstage-prevent-current-being-drawn">
<h3><a class="toc-backref" href="#id6">Amplifiers in the headstage prevent current being drawn</a><a class="headerlink" href="#amplifiers-in-the-headstage-prevent-current-being-drawn" title="Permalink to this headline">#</a></h3>
<p>A perfect 5V voltage source would always provide exactly 5 Volts, no matter what the rest of the circuit looks like. If we put a lot of high impedance components in the rest of the circuit, less current will flow, and if we put low impedance components we will get a high current.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>A real voltage source has a bit of output impedance, which means it acts as a voltage source in series with an impedance. This is modelled here (click to view high-quality version in the simulator):</p>
<a class="reference external image-reference" href="https://tinyurl.com/yfvzdxbz"><img alt="voltage sources passing a resistance to ground. Real and ideal voltage sources are compared, where real voltage sources act as a perfect voltage source in series with a small resistance." class="align-center" src="../_images/output_impedance.png" /></a>
<p>That invisible, small series resistance creates a voltage divider. Though the actual source voltage is the same 5V, the apparent voltage of the source varies depending on the ratio between the output impedance of the source, and the impedance of the rest of the circuit. The lower the impedance of the components used in the rest of the circuit, the higher the relative influence of the source output impedance, and the lower the apparent source voltage (the voltage ‘droops’).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>In our acquisition system, the voltage source is the potential changes in the extracellular fluid (V<sub>ec</sub>). The resistive and capacitive properties of the electrode create an output resistance. The relative impedance of the circuit before and after V<sub>in</sub> influences the magnitude of the signal at V<sub>in</sub>. If we allow a lot of current to flow from our electrode to ground, we have a low impedance circuit, which will distort our signal. We therefore need something with a very high impedance to stop current being drawn from our V<sub>ec</sub>. Amplifiers do exactly this: their high input impedance prevents current flow from the electrodes, and amplifiers provide the necessary current for the rest of the circuit from a separate source.</p>
</section>
<section id="the-operational-amplifier">
<h3><a class="toc-backref" href="#id7">The operational amplifier</a><a class="headerlink" href="#the-operational-amplifier" title="Permalink to this headline">#</a></h3>
<p>The ‘operational amplifier’ or ‘op-amp’ is a crucial building block of our acquisition system. The amplifier has two inputs (+ and -), one output, and two power rails (e.g. a 3 and -3V power rail).</p>
<img alt="an amplifier is represented as a triangle pointing towards the right. It has two inputs (+ and -) and one output." class="align-center" src="../_images/op-amp-basic.png" />
</section>
<section id="amplifiers-have-high-input-impedance">
<h3><a class="toc-backref" href="#id8">Amplifiers have high input impedance</a><a class="headerlink" href="#amplifiers-have-high-input-impedance" title="Permalink to this headline">#</a></h3>
<p>The amplifier input impedance, Z<sub>a</sub>is very high. The circuit acts as though the current has to cross a very high resistor to actually enter the amplifier. The current flow therefore becomes very low (Ferree et al., 2001), preventing us from drawing much current from the electrode to ground.</p>
<p>Here is the amplifier added into our circuit diagram:</p>
<img alt="../_images/circuit_electrode_shunt_amp.png" class="align-center" src="../_images/circuit_electrode_shunt_amp.png" />
</section>
<section id="amplifiers-have-low-output-impedance">
<h3><a class="toc-backref" href="#id9">Amplifiers have low output impedance</a><a class="headerlink" href="#amplifiers-have-low-output-impedance" title="Permalink to this headline">#</a></h3>
<p>The output impedance of amplifiers is very low, which means that a lot of current can flow <em>from</em> the amplifier. This current enables the driving of the signal through all the subsequent circuits (e.g., interconnect lines, multiplexer, and ADC). By placing an amplifier in our circuit, we make sure that the rest of our recording circuit is driven by current provided by the amplifier, not by current provided by the electrode tip.</p>
</section>
<section id="amplifiers-output-a-voltage">
<h3><a class="toc-backref" href="#id10">Amplifiers output a voltage</a><a class="headerlink" href="#amplifiers-output-a-voltage" title="Permalink to this headline">#</a></h3>
<p>The amplifier outputs the voltage difference between the voltages at its two inputs.</p>
<img alt="../_images/op-amp-basic.png" class="align-center" src="../_images/op-amp-basic.png" />
<p>How does it do that?</p>
<p>If the difference between its two inputs is <strong>positive</strong>, the amplifier connects its output to the positive ‘power rail’, giving a positive output voltage. If the positive power rail is 3V, the amplifier will output (pretty much) that.</p>
<p>If the difference between the two inputs is <strong>negative</strong>, the amplifier will connect its output to the negative rail, outputting -3V. While doing that, the operational amplifier draws basically no current on its inputs.</p>
<p>In this configuration, the amplifier does not distinguish between small or large differences in voltage across its inputs; it will only every output the most negative or most positive voltage it can. Another way to say that, is that it amplifies the difference between its inputs with a huge factor, also called ‘gain’. This gain is so large that the amplifier always saturates, providing either the maximum or minimum voltage it can.</p>
</section>
<section id="negative-feedback-prevents-saturation">
<h3><a class="toc-backref" href="#id11">Negative feedback prevents saturation</a><a class="headerlink" href="#negative-feedback-prevents-saturation" title="Permalink to this headline">#</a></h3>
<a class="reference external image-reference" href="https://tinyurl.com/ygby3xqh"><img alt="an amplifier with the output and negative terminal connected" class="align-center" src="../_images/op_amp_feedback.png" /></a>
<p>If we connect the output of the operational amplifier to the ‘-’ input, then the following happens:</p>
<ul class="simple">
<li><p>Initially, if ‘+’ is higher than ‘-’, the operational amplifier will output a high voltage.</p></li>
<li><p>If we connect the output back to ‘-’, the amplifier will continue to output a high voltage, but now this voltage starts to increase the value of ‘-’, bringing the value of the inputs closer together. This behaviour will keep the voltages at its ‘+’ and ‘-’ inputs the same.</p></li>
<li><p>Now, <em>the ‘-’ input is always actively driven to follow the voltage on the ‘+’ input</em>. This means that whatever voltage we connect to the ‘+’ input can be measured just by looking at the ‘-’ input (which is connected to / the same as the output). Increasing ‘+’ will induce a difference between ‘+’ and ‘-’, but the corresponding change in the amount of output voltage will bring ‘-’ back up.</p></li>
</ul>
<p>We can measure the voltage that at ‘+’ by just measuring the output of the operational amplifier, BUT because the ‘+’ input draws almost no current at all (in other words, very high input impedance), we can now measure weak signals. The output of the operational amplifier on the other hand side has very low output impedance- in other words, we can draw a lot of current from it and it will keep its voltage.</p>
<p>You can run this example in the simulator (click the image above), and see if what we said about the operational amplifier makes sense.</p>
</section>
<section id="an-op-amp-as-a-headstage">
<h3><a class="toc-backref" href="#id12">An op-amp as a headstage</a><a class="headerlink" href="#an-op-amp-as-a-headstage" title="Permalink to this headline">#</a></h3>
<p>Our electrodes will be attached to a headstage, which contains an amplifier. This amplification step performs several functions:</p>
<ul class="simple">
<li><p>Prevents us from drawing current and allows to drive current to ADC and computer</p></li>
<li><p>Rejects common mode noise</p></li>
<li><p>Increases the range of the signal to fit the dynamic range of our digitizer</p></li>
</ul>
<center><iframe width="560" height="340" src="https://www.youtube.com/embed/NP6nE5P82e8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></center>
<br></section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="theoryday1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Theory Day 1</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="theoryday3.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Theory Day 3</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2010-2022, Open Ephys, OEPS &amp; Contributors.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>