
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercises Day 3 TA &#8212; Open Ephys EEA Course Materials 0.0.0 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Terms and Conditions" href="disclaimer_terms_conditions.html" />
    <link rel="prev" title="Final Differential Amplifier" href="finaldiffamp.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">Open Ephys EEA Course Materials</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="kitlist.html">
  NeuroKit Contents
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="eeadocsindex.html">
  EEA Course Documents
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="disclaimer_terms_conditions.html">
  Terms and Conditions
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="safety.html">
   Safety &amp; Good Practices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="software_requirements.html">
   Software Requirements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theoryday1.html">
   Theory Day 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theoryday2.html">
   Theory Day 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theoryday3.html">
   Theory Day 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theoryday4.html">
   Theory Day 4
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="exday1.html">
   Exercises Day 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="sinewave.html">
     Sinewave
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exday2.html">
   Exercises Day 2
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="exday3.html">
   Exercises Day 3
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Firmata.html">
     Firmata
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project.html">
   Project
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="exday1TA.html">
   Exercises Day 1 TA
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="sinewave.html">
     Sinewave
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="exday2TA.html">
   Exercises Day 2 TA
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ampvoltagediv.html">
     Amplifier with Voltage Divider
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="soldiffamp.html">
     Differential Amplifier Solutions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="finaldiffamp.html">
     Final Differential Amplifier
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   Exercises Day 3 TA
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Firmata.html">
     Firmata
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#electrodes">
   Electrodes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instrumentation-amplifier">
   Instrumentation Amplifier
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#emg-circuit">
   EMG circuit
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#streaming-data-from-a-microcontroller">
     Streaming data from a microcontroller
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shifting-the-signal">
     Shifting the signal
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#acknowledgements">
   Acknowledgements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#licensing">
   Licensing
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="exercises-day-3-ta">
<span id="refeday3ta"></span><h1>Exercises Day 3 TA<a class="headerlink" href="#exercises-day-3-ta" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By the end of day everyone should have EMG working. Signals don’t have to be perfect, but movement should be detectable. This day is usually a lot of debugging and going over things that have been covered before, making sure everyone understands what is going on.</p>
</div>
<p>Today we are going to build an EMG circuit! We’ll use the electrodes in your kit, an instrumentation amplifier as our headstage, and the Teensy will be our acquisition board. We now have all the steps of the acquisition in place to simulate a lab experiment.</p>
<img alt="../_images/eea_fig-5.png" class="align-center" src="../_images/eea_fig-5.png" />
<div class="section" id="electrodes">
<h2>Electrodes<a class="headerlink" href="#electrodes" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Your kit contains surface electrodes that we will use for EMG. These measurements involve attaching yourself to a circuit, so follow these rules to be safe:</p>
<ol class="upperalpha simple">
<li><p>Do not use anything other than the recommended batteries to power your circuit. Do not connect your circuit to mains supply for power, ground, anything.</p></li>
<li><p>Only connect the EMG electrodes to one arm. Don’t attach them to both arms. This is to avoid any current travelling across your heart.</p></li>
<li><p>If you are using a laptop, disconnect your laptop charger &amp; run from battery while the electrodes are attached to you. This is to prevent any surges from mains supply from backpropagating through your laptop, to you.</p></li>
</ol>
</div>
<p>The electrodes clip onto the cable with three wires. We’ll be using an audio-to-breadboard jack to get the signal from the electrodes into the breadboard.</p>
</div>
<div class="section" id="instrumentation-amplifier">
<h2>Instrumentation Amplifier<a class="headerlink" href="#instrumentation-amplifier" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.analog.com/media/en/technical-documentation/data-sheets/AD622.pdf">This</a> is the datasheet for the instrumentation amplifier in your kit.</p>
<img alt="../_images/eea_fig-61.png" class="align-center" src="../_images/eea_fig-61.png" />
</div>
<div class="section" id="emg-circuit">
<h2>EMG circuit<a class="headerlink" href="#emg-circuit" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The disposable electrodes in the kit are single-use, so do not attach them until you are sure your circuit is working and that you have the correct position (see below).</p>
</div>
<p>First, we’ll wire up our electrodes to our instrumentation amp and read out the result with our oscilloscope. Later, we’ll add the Teensy.</p>
<ol class="arabic simple">
<li><p>Replicate the following circuit:</p></li>
</ol>
<img alt="../_images/eea_fig-62.png" class="align-center" src="../_images/eea_fig-62.png" />
<ul class="simple">
<li><p>Bypass capacitor = 104</p></li>
<li><p>Resistor: 220 Ohm</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Now click the surface electrodes onto the ends of the cable, and click the jack into the breadboard adaptor.</p></li>
</ol>
<ul class="simple">
<li><p>Black cable = ground electrode = Ring 1</p></li>
<li><p>Blue cable = - (reference) electrode  = Ring 2</p></li>
<li><p>Red cable = + electrode = Tip</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Attach your oscilloscope as shown:</p></li>
</ol>
<img alt="../_images/eea_fig-63.png" class="align-center" src="../_images/eea_fig-63.png" />
<p>If you tap the electrodes, you should see the trace of your PicoScope respond. If not, troubleshoot your circuit until you do.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Problems here are often:</p>
<ul class="simple">
<li><p>Forgetting to connect both grounds</p></li>
<li><p>Being offset by 1 position in breadboard. Get the group to help each other spotting small errors like that.</p></li>
</ul>
</div>
<p>3.      If your picoscope responds to tapping your electrodes, you are ready to measure EMG!
Place the measurement and reference electrode very close together, on the part of the forearm where you can feel your muscle when you tense it.  You should see a clear signal in the oscilloscope when you tense your muscles. Moving your arm will cause large motion artefacts (why?) so try to find a setup that gives you a consistent and clear signal.</p>
<ol class="arabic simple" start="4">
<li><p>The resistor across the instrumentation amplifier sets the gain of the amplifier. Change the gain of the amplifier by changing Rg. What happens when the value for Rg is very low?</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you have a lot of noise on your recording, try:</p>
<ul class="simple">
<li><p>Disconnecting from 60/50Hz contaminated ground by using laptop battery</p></li>
<li><p>Try twisting or braiding the cables</p></li>
</ul>
</div>
<div class="section" id="streaming-data-from-a-microcontroller">
<h3>Streaming data from a microcontroller<a class="headerlink" href="#streaming-data-from-a-microcontroller" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
</div>
<p>We’re going to start streaming data to the pc, by using our Teensy microcontroller to digitize the analog signals we collect.</p>
<ol class="upperalpha simple">
<li><p>Connect the output from your amplifier to an analog input node on the Teensy as shown below. This is a 220 Ohm resistor across the instrumentation amplifier, and a voltage divider made of two equal resistors (anything above 1KOhm, see the text on ‘shifting the bipolar signal up’ below).</p></li>
<li><p>Upload ‘Firmata.ino’ to the Teensy (code here: <a class="reference internal" href="Firmata.html#firmata"><span class="std std-ref">Firmata</span></a> )</p></li>
<li><p>Open Bonsai and create an Analog Input node. Double-click to visualise your signal.</p></li>
<li><p>Connect this to a ‘Csv Writer’ node to save your signals.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It should work with just ‘AnalogInput’. It’s nicer to use the ‘CreateArduino’ node and specify the Teensy, this also allows you to set the sampling interval, so you can increase it if the computer is struggling. Use .csvwriter to save signals.</p>
</div>
</div>
<div class="section" id="shifting-the-signal">
<h3>Shifting the signal<a class="headerlink" href="#shifting-the-signal" title="Permalink to this headline">¶</a></h3>
<p>The EMG signal is from -3 to +3V, but we can only digitize positive voltages. With a simple trick we can shift the signal up from -3 to 3V exactly into the 0-3V range we want, while still providing the amplifier with a -3 to +3V range.</p>
<img alt="../_images/eea_fig-64.png" class="align-center" src="../_images/eea_fig-64.png" />
<img alt="../_images/eea_fig-65.png" class="align-center" src="../_images/eea_fig-65.png" />
<p>This voltage divider is not going to mess with our signal, because the signal is protected by the amplifier. You could in theory use almost any reasonable values for R, over 1kΩ, because the output impedance of the instrumentation amplifier is low and the input impedance (of the teensy analog input) is decently high. If you make R too small, this will still work on paper, but you’re now asking the op-amp to keep shovelling current into ground (or in this case, the 3V rail) through a small R, and eventually even an op-amp will get unhappy.</p>
</div>
</div>
<div class="section" id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>Written by:</p>
<ul class="simple">
<li><p>Alexandra Leighton</p></li>
<li><p>Joana Neto</p></li>
<li><p>Jakob Voigts</p></li>
<li><p>Aarón Cuevas López</p></li>
<li><p>Jon Newman</p></li>
</ul>
<p>With material from:</p>
<ul class="simple">
<li><p>Joana Neto, 2018; Materials and neuroscience: validating tools for large-scale, high-density neural recording, 2018.</p></li>
<li><p>Jon Newman and Jakob Voigts, 2017; Intro to Chronic Ephys (presentation at TENSS)</p></li>
<li><p>Mitra Javadzadeh, 2017; Building an analog ephys recording system (practical exercises developed for TENSS)</p></li>
</ul>
</div>
<div class="section" id="licensing">
<h2>Licensing<a class="headerlink" href="#licensing" title="Permalink to this headline">¶</a></h2>
<p>This work is licensed under CC BY-SA 4.0.</p>
<p>To view a copy of this license, visit <a class="reference external" href="https://creativecommons.org/licenses/by-sa/4.0/">https://creativecommons.org/licenses/by-sa/4.0/</a></p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="finaldiffamp.html" title="previous page">Final Differential Amplifier</a>
    <a class='right-next' id="next-link" href="disclaimer_terms_conditions.html" title="next page">Terms and Conditions</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2010-2021, Open Ephys, OEPS &amp; Contributors.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.1.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>